library(ggplot2)
nba <- read.csv("http://datasets.flowingdata.com/ppg2008.csv")
nba$Name <- with(nba, reorder(Name, PTS))
nba
nba.m <- melt(nba)
?melt
??melt
install.packages("reshape")
library(reshape)
nba.m <- melt(nba)
nba.m
nba <- read.csv("http://datasets.flowingdata.com/ppg2008.csv")
nba
nba$Name <- with(nba, reorder(Name, PTS))
nba
nba.m
head(nba.m)
+     rescale = rescale(value))
nba.m <- ddply(nba.m, .(variable), transform,rescale = rescale(value))
??ddply
install.packages("dplyr")
nba.m <- ddply(nba.m, .(variable), transform,rescale = rescale(value))
library("scales")
nba.m <- ddply(nba.m, .(variable), transform,rescale = rescale(value))
library(scales)
nba.m <- ddply(nba.m, .(variable), transform,rescale = rescale(value))
library(plyr)
nba.m <- ddply(nba.m, .(variable), transform,rescale = rescale(value))
nba.m
head(nba.m)
+     high = "steelblue"))
> (p <- ggplot(nba.m, aes(variable, Name)) + geom_tile(aes(fill = rescale),colour = "white") + scale_fill_gradient(low = "white",    high = "steelblue"))
(p <- ggplot(nba.m, aes(variable, Name)) + geom_tile(aes(fill = rescale),colour = "white") + scale_fill_gradient(low = "white",    high = "steelblue"))
data("USPersonalExpenditure")
USPersonalExpenditure
pheatmap::pheatmap(USPersonalExpenditure)
pheatmap::pheatmap(USPersonalExpenditure)
mtcars
library(datasets)
head(iris)
library(ggplot2)
ggplot(iris, aes(Petal.Length, Petal.Width, color = Species)) + geom_point()
set.seed(20)
irisCluster <- kmeans(iris[, 3:4], 3, nstart = 20)
irisCluster
table(irisCluster$cluster, iris$Species)
irisCluster
irisCluster$cluster <- as.factor(irisCluster$cluster)
ggplot(iris, aes(Petal.Length, Petal.Width, color = irisCluster$cluster)) + geom_point()
clusters <- hclust(dist(iris[, 3:4]))
plot(clusters)
clusterCut <- cutree(clusters, 3)
table(clusterCut, iris$Species)
clusters <- hclust(dist(iris[, 3:4]), method = 'average')
plot(clusters)
clusterCut <- cutree(clusters, 3)
table(clusterCut, iris$Species)
ggplot(iris, aes(Petal.Length, Petal.Width, color = iris$Species)) +
geom_point(alpha = 0.4, size = 3.5) + geom_point(col = clusterCut) +
scale_color_manual(values = c('black', 'red', 'green'))
iris
head(iris)
clusters <- hclust(dist(iris[, 3:4]))
plot(clusters)
clusters <- hclust(dist(iris[, 3:4]))
plot(clusters)
clusters_ex <- hclust(dist(iris[, 3:4]))
plot(clusters_ex)
setwd("/media/tempData/claudia/R/git_proj/")
devtools::document()
setwd("/media/tempData/claudia/R/chipAnalyseR/")
devtools::document()
devtools::install()
setwd("/media/tempData/claudia/R/git_proj/chipAnalyseR/")
devtools::document
devtools::document()
devtools::install()
devtools::document()
devtools::install()
markdown::help
?markdown
devtools::document()
devtools::install()
devtools::document()
devtools::install()
setwd("/media/tempData/claudia/R/GSE99171_RAW/")
BRD4_mat = chipAnalyseR::get_matrix(bed = "GSM2634756_U87_BRD4_peaks.narrowPeak", bw_files = c("GSM2634756_U87_BRD4.bw", "GSM2634758_U87_BRD4_dBET_2h.bw", "GSM2634757_U87_BRD4_dBET_24h.bw"), bw_path = "/media/tempData/claudia/R/", op_dir = "/media/tempData/claudia/R/GSE99171_RAW/", binsize = 10)
pdf(file = "BRD4_hm.pdf")
chipAnalyseR::plot_hm(mat = BRD4_mat)
dev.off()
setwd("/media/tempData/claudia/R/git_proj/chipAnalyseR/")
devtools::document()
devtools::install()
setwd("/media/tempData/claudia/R/GSE99171_RAW/")
pdf(file = "BRD4_hm.pdf")
chipAnalyseR::plot_hm(mat = BRD4_mat)
dev.off()
chipAnalyseR::plot_hm(mat = BRD4_mat)
pdf(file = "BRD4_hm.pdf")
chipAnalyseR::plot_hm(mat = BRD4_mat)
dev.off()
BRD4_mat = chipAnalyseR::get_matrix(bed = "GSM2634756_U87_BRD4_peaks.narrowPeak", bw_files = c("GSM2634756_U87_BRD4.bw", "GSM2634758_U87_BRD4_dBET_2h.bw", "GSM2634757_U87_BRD4_dBET_24h.bw"), bw_path = "/media/tempData/claudia/R/", op_dir = "/media/tempData/claudia/R/GSE99171_RAW/",up = 2500, down = 2500, pos = '', binsize = 10, numcores = )
BRD4_auc = chipAnalyseR::auc_pi(bed = "GSM2634756_U87_BRD4_peaks.narrowPeak", bw_files = c("GSM2634756_U87_BRD4.bw", "GSM2634758_U87_BRD4_dBET_2h.bw", "GSM2634757_U87_BRD4_dBET_24h.bw"), bw_path = "/media/tempData/claudia/R/", op_dir = "/media/tempData/claudia/R/GSE99171_RAW/", numcores = 6)
chipAnalyseR::plot_MA(aucpi = BRD4_mat, anno = "/media/tempData/claudia/R/GSE99171_RAW/auc/BRD4_2h.txt", cond = c("BRD4", "BRD4_dBET6"))
chipAnalyseR::plot_MA(aucpi = BRD4_mat, anno = "/media/tempData/claudia/R/GSE99171_RAW/auc/BRD4_2h.txt", cond = c("BRD4", "BRD4_dBET6"))
chipAnalyseR::plot_profile(mat_sum = BRD4_mat, opt = 'mean')
chipAnalyseR::peak_annos(p_anno = c("peak_anno/GSM2634756_U87_BRD4_peaks.narrowPeak.anno", "peak_anno/GSM2634758_U87_BRD4_dBET_2h_peaks.narrowPeak.anno"), state2color = "seg.txt")
pol2_index = chipAnalyseR::pol2_index(gm = "/media/tempData/claudia/R/sig/hg19_refflat_1k.tsv", bw_files = c("GSM2634756_U87_BRD4.bw", "GSM2634758_U87_BRD4_dBET_2h.bw", "GSM2634757_U87_BRD4_dBET_24h.bw"), bw_path = "/media/tempData/claudia/R/", op_dir = "/media/tempData/claudia/R/GSE99171_RAW/", filter = TRUE, numcores = 6 )
chipAnalyseR::plot_pol2i(pol2_table = pol2_index)
pol2_index = chipAnalyseR::pol2_index(gm = "/media/tempData/claudia/R/sig/hg19_refflat_1k.tsv", bw_files = c("GSM2634756_U87_BRD4.bw", "GSM2634757_U87_BRD4_dBET_24h.bw"), bw_path = "/media/tempData/claudia/R/", op_dir = "/media/tempData/claudia/R/GSE99171_RAW/", filter = TRUE, numcores = 6 )
chipAnalyseR::plot_profile(mat_sum = BRD4_mat, opt = 'mean')
chipAnalyseR::plot_pol2i(pol2_table = pol2_index)
setwd("/media/tempData/claudia/R/git_proj/chipAnalyseR/")
devtools::document()
devtools::install()
